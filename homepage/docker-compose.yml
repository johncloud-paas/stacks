version: "3.3"

services:
    homepage:
        image: ghcr.io/gethomepage/homepage:latest
        user: 1000:1000
        restart: unless-stopped
        volumes:
            - $JOHNCLOUD_ROOT/$COMPOSE_PROJECT_NAME/config:/app/config # Make sure your local config directory exists
            - /var/run/docker.sock:/var/run/docker.sock # (optional) For docker integrations
        labels:
            - "traefik.enable=true"
            - "traefik.http.routers.$COMPOSE_PROJECT_NAME.rule=Host(`$HOST`)"
            - "traefik.http.routers.$COMPOSE_PROJECT_NAME.entrypoints=websecure"
            - "traefik.http.routers.$COMPOSE_PROJECT_NAME.tls.certresolver=letsencrypt"
            - "traefik.http.routers.$COMPOSE_PROJECT_NAME.middlewares=forward-auth-verify"

networks:
  default:
    external: true
    name: $TRAEFIK_NETWORK

